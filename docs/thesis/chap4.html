<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
           "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<meta name="GENERATOR" content="TtH 3.22">
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>

                                                                                      
<title>Chapter 4: Shock Surface Ripples</title>

  
 <h1><a name="tth_chAp4">
Chapter 4 </a><br />Shock Surface Ripples</h1>
<a name="chap:ripples">
</a>

<div class="p"></div>
This chapter presents our study of ion scale ripples, which are seen to move along the shock front in two-dimensional hybrid simulations [<a href="#winske+quest88" name="CITEwinske+quest88">Winske &amp; Quest, 1988</a>].  We simulate these ripples using a pre-existing hybrid code, which was written by <a href="#matthews94" name="CITEmatthews94">Matthews [1994]</a> and subsequently parallelised by <a href="#woodcock97" name="CITEwoodcock97">Woodcock [1997]</a>.  In our simulations, ripples are seen to move along the ramp and overshoot.  They are most clearly visible in the shock normal component of the magnetic field, B<sub>x</sub>; a strictly one dimensional shock would have a constant normal magnetic field component.  The process that generates the ripples remains poorly understood because high field gradients at the overshoot cause difficulty in identifying instabilities there.  One possible mechanism is an instability driven by reflected ions gyrating back into the shock [<a href="#mckean++95" name="CITEmckean++95">McKean <em>et&nbsp;al.</em>, 1995</a>].  Ripples could also be caused by wave trapping at the front due to the variation of the Alfv&#233;n speed through the shock ramp and overshoot, and we argue that ripples at the shock front are formed by the excitation of a surface wave mode. 

<div class="p"></div>
 <h2><a name="tth_sEc4.1">
4.1</a>&nbsp;&nbsp;Previous Work</h2>

<div class="p"></div>
<a href="#winske+quest88" name="CITEwinske+quest88">Winske &amp; Quest [1988]</a> used a 2-D hybrid simulation to examine the relaxation of the highly anisotropic ion distribution that is produced at a quasi-perpendicular shock front as a result of ion reflection.  They found that low frequency waves were produced behind the shock front that could be understood in terms of linear theory when applied to the Alfv&#233;n Ion-Cyclotron instability.  <a href="#mckean++95" name="CITEmckean++95">McKean <em>et&nbsp;al.</em> [1995]</a> also used a 2-D hybrid code to show that the Alfv&#233;n Ion-Cyclotron and mirror mode activity that is observed in the Earth's magnetosheath is generated near the bow shock and convected away.  They found that wave activity peaks at the shock front and then falls by an order of magnitude within several ion inertial lengths (v<sub>A</sub> <font face="symbol">W</font
><sub>i</sub><sup><font face="symbol">-</font
>1</sup>) of the shock.

<div class="p"></div>
At the shock ramp, however, <a href="#winske+quest88" name="CITEwinske+quest88">Winske &amp; Quest [1988]</a> found that measured wavelengths were not consistent with linear theory.  They found that "ripples", in the form of large magnetic field and density oscillations propagate parallel to the magnetic field in the shock ramp.  Indirect observational evidence for these ripples comes from measurements of whistler waves propagating upstream of planetary shocks in the "out-of-coplanarity" direction [<a href="#fairfield74" name="CITEfairfield74">Fairfield, 1974</a>,<a href="#orlowski+russell91" name="CITEorlowski+russell91">Orlowski &amp; Russell, 1991</a>,<a href="#orlowski++95" name="CITEorlowski++95">Orlowski <em>et&nbsp;al.</em>, 1995</a>].  <a href="#hellinger++96" name="CITEhellinger++96">Hellinger <em>et&nbsp;al.</em> [1996]</a> and <a href="#hellinger+mangeney97" name="CITEhellinger+mangeney97">Hellinger &amp; Mangeney [1997]</a> used a 3-D hybrid code to show that "out-of-coplanarity" upstream whistlers are produced at the shock ramp.  Their simulations also produced rippling at the shock front and it appears that these upstream whistlers are generated by the shock front rippling.

<div class="p"></div>
There are a number of processes that are candidates for the generation of ripples.  <a href="#winske+quest88" name="CITEwinske+quest88">Winske &amp; Quest [1988]</a> suggested that the shock ripples are driven in a non-linear fashion by the Alfv&#233;n Ion-Cyclotron instability.  By comparing with simulation results, they found that linear theory provides a good description of the plasma downstream of the shock.  Their attempt to describe the structure at the shock front was, however, unsuccessful.  This was not surprising, since the assumption of local homogeneity is not applicable in the high field gradients and the dynamics of the shock front are likely to be non-linear.

<div class="p"></div>
<a href="#hellinger++96" name="CITEhellinger++96">Hellinger <em>et&nbsp;al.</em> [1996]</a> found that, for an inflow speed into the simulation box of 2 v<sub>A</sub>, they generated a slightly supercritical shock with M<sub>A</sub>=3.3.  In this case, the Alfv&#233;n Ion-Cyclotron mode was not excited, but upstream whistlers were still generated.  <a href="#hellinger+mangeney97" name="CITEhellinger+mangeney97">Hellinger &amp; Mangeney [1997]</a> found that ripples were not generated at these slightly supercritical shocks.  <a href="#hellinger++96" name="CITEhellinger++96">Hellinger <em>et&nbsp;al.</em> [1996]</a> and <a href="#hellinger+mangeney97" name="CITEhellinger+mangeney97">Hellinger &amp; Mangeney [1997]</a> suggested that a more likely mechanism for ripple generation is the gyrating gyrotropic proton beam instability [<a href="#wong+goldstein88" name="CITEwong+goldstein88">Wong &amp; Goldstein, 1988</a>], which involves reflected ions gyrating back into the shock.  We present evidence to suggest that ripples could be caused by wave trapping at the front due to the variation of the Alfv&#233;n speed through the shock ramp and overshoot.

<div class="p"></div>
 <h2><a name="tth_sEc4.2">
4.2</a>&nbsp;&nbsp;Simulation Configuration</h2>

<div class="p"></div>
Our simulation of the shock fields uses the CAM-CL hybrid code discussed in Chapter <a href="#chap:simulation">3</a> and implemented by <a href="#matthews94" name="CITEmatthews94">Matthews [1994]</a> and <a href="#woodcock97" name="CITEwoodcock97">Woodcock [1997]</a>.  This models the plasma in a self-consistent manner as ion macroparticles and an inertialess electron fluid.  Our simulations are 2-D in space and 3-D in velocity.  The choice of a hybrid code means that electron physics is not well modelled, so it is possible that, in reality, accelerated electrons might damp the ripples. Our hybrid simulation is also unable to model electron scale turbulence and electron scale ripples, which are seen in full particle PIC codes and may affect the dynamics. Micro-turbulence associated with currents along the shock, for example, could alter the growth and structure of the ion scale ripples. Whilst electron inertial scales could be included by using a full particle code, the time and length scales associated with ion scale rippling are generally too long to be modelled in this way.

<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.1">
</a> <center><a href="figs/ripples/shk_geom.eps">
<img alt="shk_geom" src="images/shk_geom.gif" border="0"></a>

<center>Figure 4.1: The geometry of a collisionless shock, as used in our simulations and discussion of electron acceleration mechanisms.  The magnetic field <b>B</b>, inflow velocity <b>V</b><sub><b>0</b></sub> and shock normal [^(<b>n</b>)] are co-planar.  In this geometry, the reference frame is such that <b>V</b><sub><b>0</b></sub> and [^(<b>n</b>)] are anti-parallel.</center>
<a name="fig:shk_geom">
</a>
</center>
<div class="p"></div>
We generate a shock by reflecting homogeneous plasma moving at constant velocity off a stationary, perfectly conducting barrier, which provides a clean shock once the shock front is clear of the reflecting barrier.  The plasma flows in from the left hand x boundary and reflects at the right hand x boundary.  The y boundary conditions are periodic.  The simulation geometry is shown in Figure <a href="#fig:shk_geom">4.1</a> and the standard parameters for our simulations are shown in Table <a href="#tab:std_params">4.1</a>.

<div class="p"></div>

<div class="p"></div>
<a name="tth_tAb4.1">
</a> <center>
<table>
<tr><td>Parameter </td><td align="center">Symbol </td><td align="center">Value </td></tr>
<tr><td>cell size in x </td><td align="center"><font face="symbol">D</font
>x </td><td align="center">0.2 v<sub>A</sub> <font face="symbol">W</font
><sub>i</sub><sup><font face="symbol">-</font
>1</sup> </td></tr>
<tr><td>cell size in y </td><td align="center"><font face="symbol">D</font
>y </td><td align="center">0.2 v<sub>A</sub> <font face="symbol">W</font
><sub>i</sub><sup><font face="symbol">-</font
>1</sup> </td></tr>
<tr><td>time step </td><td align="center"><font face="symbol">D</font
>t </td><td align="center">0.01 <font face="symbol">W</font
><sub>i</sub><sup><font face="symbol">-</font
>1</sup> </td></tr>
<tr><td>number of cells in x </td><td align="center">n<sub>x</sub> </td><td align="center">360 </td></tr>
<tr><td>number of cells in y </td><td align="center">n<sub>y</sub> </td><td align="center">128 </td></tr>
<tr><td>number of time steps</td><td align="center">n<sub>t</sub> </td><td align="center">4000 </td></tr>
<tr><td>electron plasma beta </td><td align="center"><font face="symbol">b</font
><sub>e</sub> </td><td align="center">0.5 </td></tr>
<tr><td>perpendicular ion temperature </td><td align="center">T<sub>i<font face="symbol">^</font
></sub> </td><td align="center">0.5 </td></tr>
<tr><td>parallel ion temperature </td><td align="center">T<sub>i<font face="symbol">||</font
></sub> </td><td align="center">0.5 </td></tr>
<tr><td>number of field substeps </td><td align="center">n<sub>s</sub> </td><td align="center">10 </td></tr>
<tr><td>number of ions per cell </td><td align="center"></td><td align="center">50 </td></tr></table>


<center>Table 4.1: Typical simulation parameters.</center>
<a name="tab:std_params">
</a>
</center>
<div class="p"></div>
The speed of the shock front was determined by using the mean value of the magnetic field integrated along the y direction, <font face="symbol">á</font
>B <font face="symbol">ñ</font
>.  The shock front was considered to be located at the position where this quantity reached 2 B<sub>0</sub>.  In reality, this corresponds to a region close to the foot of the shock, but the speed of this point proved to be remarkably stable throughout a simulation.  Studies of shock structure which used this point as a baseline produced results which were equivalent to simply assuming a constant speed for the shock front.  As a result, we have used the point where <font face="symbol">á</font
>B <font face="symbol">ñ</font
> =  2 B<sub>0</sub> as the origin for the x co-ordinate in the following discussion when quantities are described relative to the position of the shock front.  The shock speeds for different cases using this criterion are shown in Table <a href="#tab:inflow_shock">4.2</a>, where the shock Alfv&#233;n Mach number in the normal incidence frame, M<sub>A</sub>, is tabulated against the plasma inflow velocity in the simulation frame, V<sub><span class="roman">in</span></sub>.  The shape of the shock was not constant, however, so the position and height of the overshoot vary slightly over time.  

<div class="p"></div>

<div class="p"></div>
<a name="tth_tAb4.2">
</a> <center>
<table>
<tr><td align="center">Plasma inflow speed in </td><td colspan="2" align="center">shock Alfv&#233;n Mach number, M<sub>A</sub> </td></tr>
<tr><td align="center">simulation frame, V<sub><span class="roman">in</span></sub> </td><td align="center"><font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=85<sup><font face="symbol">°</font
></sup> </td><td align="center"><font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=88<sup><font face="symbol">°</font
></sup> </td></tr>
<tr><td align="center">2 v<sub>A</sub>  </td><td align="center">3.32 </td><td align="center">3.33 </td></tr>
<tr><td align="center">4 v<sub>A</sub> </td><td align="center">5.66 </td><td align="center">5.66 </td></tr>
<tr><td align="center">6 v<sub>A</sub> </td><td align="center">8.29 </td><td align="center">8.21 </td></tr></table>


<center>Table 4.2: Relationship between the plasma inflow speed in the frame of the simulation (which is a parameter of the simulation) and in the frame of the shock (which gives the shock's Alfv&#233;n Mach number).</center>
<a name="tab:inflow_shock">
</a>
</center>
<div class="p"></div>
 <h2><a name="tth_sEc4.3">
4.3</a>&nbsp;&nbsp;Overview of Structure</h2>

<div class="p"></div>
We conduct simulations using two orientations of the upstream magnetic field, <b>B</b><sub>0</sub>. The first has <b>B</b><sub>0</sub> lying in the plane of the simulation, allowing particles to move along the field line and feel the full 2-D field structure. The second has <b>B</b><sub>0</sub> pointing out of the simulation plane, so that the particles feel no variation along the field line associated with 2-D structure. This configuration is intended to mimic a 1-D simulation.

<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.2">
</a> <center>

<a href="figs/ripples/th88_B_cmpts.eps">
<img alt="th88_B_cmpts" src="images/th88_B_cmpts.gif" border="0"></a>
<div class="p"></div>
<a href="figs/ripples/th88_E_cmpts.eps">
<img alt="th88_E_cmpts" src="images/th88_E_cmpts.gif" border="0"></a>

<center>Figure 4.2: Diagram of all <b>E</b> and <b>B</b> components for <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=88<sup><font face="symbol">°</font
></sup>, V<sub><span class="roman">in</span></sub>=4v<sub>A</sub> for a simulation where the upstream magnetic field lies in the plane of the simulation.</center>
<a name="fig:EB_fields">
</a>
</center>
<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.3">
</a> <center>

<a href="figs/ripples/th88_Btot.eps">
<img alt="th88_Btot" src="images/th88_Btot.gif" border="0"></a>&nbsp;&nbsp;&nbsp;
<a href="figs/ripples/th88_Etot.eps">
<img alt="th88_Etot" src="images/th88_Etot.gif" border="0"></a>

<div class="p"></div>
<a href="figs/ripples/th88_alfven.eps">
<img alt="th88_alfven" src="images/th88_alfven.gif" border="0"></a>&nbsp;&nbsp;&nbsp;
<a href="figs/ripples/th88_rho.eps">
<img alt="th88_rho" src="images/th88_rho.gif" border="0"></a>

<div class="p"></div>
<center>Figure 4.3: Diagram of Alfv&#233;n speed, density and the magnitudes of <b>E</b> and <b>B</b> components for <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=88<sup><font face="symbol">°</font
></sup>, V<sub><span class="roman">in</span></sub>=4v<sub>A</sub> for a simulation where the upstream magnetic field lies in the plane of the simulation.</center>
<a name="fig:sum_fields">
</a>
</center>
<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.4">
</a> <center>

<a href="figs/ripples/th88_out_B_cmpts.eps">
<img alt="th88_out_B_cmpts" src="images/th88_out_B_cmpts.gif" border="0"></a>
<div class="p"></div>
<a href="figs/ripples/th88_out_E_cmpts.eps">
<img alt="th88_out_E_cmpts" src="images/th88_out_E_cmpts.gif" border="0"></a>

<center>Figure 4.4: Diagram of all <b>E</b> and <b>B</b> components for <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=88<sup><font face="symbol">°</font
></sup>, V<sub><span class="roman">in</span></sub>=4v<sub>A</sub> for a simulation where the upstream magnetic field points out of the plane of the simulation.</center>
<a name="fig:EB_fields_out of plane">
</a>
</center>
<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.5">
</a> <center>

<a href="figs/ripples/th88_out_Btot.eps">
<img alt="th88_out_Btot" src="images/th88_out_Btot.gif" border="0"></a>&nbsp;&nbsp;&nbsp;
<a href="figs/ripples/th88_out_Etot.eps">
<img alt="th88_out_Etot" src="images/th88_out_Etot.gif" border="0"></a>

<div class="p"></div>
<a href="figs/ripples/th88_out_alfven.eps">
<img alt="th88_out_alfven" src="images/th88_out_alfven.gif" border="0"></a>&nbsp;&nbsp;&nbsp;
<a href="figs/ripples/th88_out_rho.eps">
<img alt="th88_out_rho" src="images/th88_out_rho.gif" border="0"></a>

<div class="p"></div>

<center>Figure 4.5: Diagram of Alfv&#233;n speed, density and the magnitudes of <b>E</b> and <b>B</b> for <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=88<sup><font face="symbol">°</font
></sup>, V<sub><span class="roman">in</span></sub>=4v<sub>A</sub> for a simulation where the upstream magnetic field points out of the plane of the simulation.</center>
<a name="fig:sum_fields_out of plane">
</a>
</center>
<div class="p"></div>
Figures <a href="#fig:EB_fields">4.2</a> and <a href="#fig:sum_fields">4.3</a> show our simulation at <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=88<sup><font face="symbol">°</font
></sup> with the upstream magnetic field, <b>B</b><sub><span class="roman">0</span></sub>, lying in the simulation plane.  These should be contrasted with Figures <a href="#fig:EB_fields_out of plane">4.4</a> and <a href="#fig:sum_fields_out of plane">4.5</a>, which show the equivalent simulation when <b>B</b><sub><span class="roman">0</span></sub> is pointing out of the simulation plane so that the y and z axes are effectively interchanged.  Figures <a href="#fig:EB_fields">4.2</a> and <a href="#fig:EB_fields_out of plane">4.4</a> show maps of the magnetic and electric field components.  

<div class="p"></div>
In our simulations, ripples are ion scale features at the shock front, which are seen to move along the shock surface.  The ripples are most clearly visible in the shock normal component of the magnetic field in Figure <a href="#fig:EB_fields">4.2</a>, although there is also clear evidence of structure due to rippling in the largest field component, B<sub>y</sub>.  The waves caused by rippling can be seen in the B<sub>x</sub> component with a wavelength of a few ion inertial lengths and an amplitude of around 2B<sub>0</sub>. These peaks also appear to be connected to structure behind the shock.

<div class="p"></div>
The B<sub>z</sub> field component shows a significant amount of structure, although there is no obvious characteristic wavelength or correlation with any of the other magnetic field components.  This lack of correlation is illustrated by Figure <a href="#fig:hodogram_bxz">4.6</a>, which shows a hodogram of the B<sub>x</sub> and B<sub>z</sub> field components at the overshoot.  This suggests that the two perpendicular wave directions are not related by the rippling mechanism.  This result is in agreement with <a href="#winske+quest88" name="CITEwinske+quest88">Winske &amp; Quest [1988]</a>.

<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.6">
</a> <center><a href="figs/ripples/hodogram_bxz_th88m4.eps">
<img alt="hodogram_bxz_th88m4" src="images/hodogram_bxz_th88m4.gif" border="0"></a>

<center>Figure 4.6: This hodogram illustrates the lack of correlation between the B<sub>x</sub> and B<sub>z</sub> field components at the overshoot.</center>
<a name="fig:hodogram_bxz">
</a>
</center>
<div class="p"></div>
The electric field components are related to the cross-product of the magnetic field and the plasma inflow velocity.  Significant amounts of field structure are therefore seen in all the electric field components.  The E<sub>x</sub> component is the only one of the six field components in which the bimodal nature of the overshoot fields is visible.  

<div class="p"></div>
This contrasts with Figure <a href="#fig:EB_fields_out of plane">4.4</a>, where structure is suppressed by restricting spatial field variations along field lines.  The B<sub>x</sub> component is virtually eliminated, as would be expected for a one-dimensional shock.  When compared to Figure <a href="#fig:EB_fields">4.2</a>, there is virtually no field structure along the y axis in any of the field components.  As a result of this, the bimodal nature of the overshoot can be clearly seen in most of the magnetic and electric field components.

<div class="p"></div>
Figures <a href="#fig:sum_fields">4.3</a> and <a href="#fig:sum_fields_out of plane">4.5</a> show maps of the density and Alfv&#233;n speed, in addition to the total electric and magnetic fields, for the two orientations of <b>B</b><sub><span class="roman">0</span></sub>.  Superimposed are graphs showing how the magnitude of the mapped quantities varies with distance from the shock front.  These magnitudes are calculated by taking the mean value over the y direction, averaging over the 2-D structure.

<div class="p"></div>
All four quantities in Figure <a href="#fig:sum_fields">4.3</a> show significant structure along the shock overshoot together with an uneven shock surface.  Each of the graphs also shows evidence of a bimodal nature to the parameters at overshoot.  The integrated fields in Figure <a href="#fig:sum_fields_out of plane">4.5</a> are broadly similar, although the lack of significant y structure in the shock front again means that the bimodal nature of the overshoot is better resolved when <b>B</b><sub><span class="roman">0</span></sub> is out of the simulation plane.  This suggests that rippling does not significantly affect other properties of the shock, such as the shock width and the presence of the foot, ramp and overshoot.  The similarity of the integrated fields in the two cases can therefore give us confidence that the two simulations are indeed comparable.  The simulation with <b>B</b><sub><span class="roman">0</span></sub> out of the simulation plane allows us to compare the rippled shock front with a simulation comparable with those conducted by <a href="#kraussvarban++89" name="CITEkraussvarban++89">Krauss-Varban <em>et&nbsp;al.</em> [1989]</a>.  This gives us a choice of fields with and without ripples, but with similar simulation noise in both cases.  This is particularly important when studying pitch angle scattering, since we know that this can be introduced by numerical effects, as discussed in Chapter <a href="#chap:elec_pop">5</a>.

<div class="p"></div>
 <h2><a name="tth_sEc4.4">
4.4</a>&nbsp;&nbsp;Ripple Properties</h2>

<div class="p"></div>
The B<sub>x</sub> field component would appear to be a useful diagnostic in determining the properties of ripples.  If we wish to examine how the ripples in B<sub>x</sub> vary with distance from the shock, the method of averaging the field component over a slice is inappropriate, as the field averages to zero, as would be expected for a 1-D shock.  If, instead, we average the quantity B<sub>x</sub><sup>2</sup> then we obtain a measure of the power in the ripples, which does not vanish when averaged over y.  In fact, a good diagnostic for the amount of 2-D structure in any given quantity, Q, is its variance, <span class="roman">Var</span>(Q) = <font face="symbol">á</font
>Q<sup>2</sup> <font face="symbol">ñ</font
><font face="symbol">-</font
> <font face="symbol">á</font
>Q <font face="symbol">ñ</font
><sup>2</sup>.  For nearly perpendicular shocks, however, <font face="symbol">á</font
>B<sub>x</sub> <font face="symbol">ñ</font
> <font face="symbol">»</font
> 0.

<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.7">
</a> <center><a href="figs/ripples/varBx_vs_overshoot.eps">
<img alt="varBx_vs_overshoot" src="images/varBx_vs_overshoot.gif" border="0"></a>

<center>Figure 4.7: Graph showing how the power in the shock ripples increases with the size of the overshoot.  The points from simulations with rippling are labelled with their value of <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>.</center>
<a name="fig:varBx_vs_overshoot">
</a>
</center>
<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.8">
</a> <center><a href="figs/ripples/varBx_vs_tBn.eps">
<img alt="varBx_vs_tBn" src="images/varBx_vs_tBn.gif" border="0"></a>

<center>Figure 4.8: Graph showing how the power in the ripples increases with <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub> for an inflow speed of 4v<sub>A</sub>.</center>
<a name="fig:varBx_vs_tBn">
</a>
</center>
<div class="p"></div>
Figure <a href="#fig:varBx_vs_overshoot">4.7</a> plots Var(B<sub>x</sub>) against (<font face="symbol">á</font
>B<sub>1</sub> <font face="symbol">ñ</font
><font face="symbol">-</font
> <font face="symbol">á</font
>B<sub>2</sub> <font face="symbol">ñ</font
><sub><span class="roman">max</span></sub>) for the sample of ten shocks that are used in the simulations described in Chapter <a href="#chap:elec_acceln">6</a>.  The properties of these shocks are listed in Table <a href="#tab:shock_properties">6.2</a>.  Var(B<sub>x</sub>) is a good diagnostic of the amount of structure in the B<sub>x</sub> field component and provides a measure of the power in the shock ripples.  The quantity (<font face="symbol">á</font
>B<sub>1</sub> <font face="symbol">ñ</font
><font face="symbol">-</font
> <font face="symbol">á</font
>B<sub>2</sub> <font face="symbol">ñ</font
><sub><span class="roman">max</span></sub>) is the difference between the maximum magnetic field in the shock transition and the maximum value of the downstream (x &gt; 5 v<sub>A</sub> <font face="symbol">W</font
><sub>i</sub><sup><font face="symbol">-</font
>1</sup>) magnetic field, with both fields averaged over the y direction.  This quantity gives a good idea of the size of the overshoot compared to the downstream fluctuations and falls to approximately zero in the case of a subcritical shock, which has no overshoot.  This quantity depends very strongly on the inflow plasma speed, but much more weakly on <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub> over the range <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub> &gt;~80<sup><font face="symbol">°</font
></sup>.  Figure <a href="#fig:varBx_vs_overshoot">4.7</a> is consistent with a linear relationship between the power in the ripples and the size of the overshoot.  The <font face="symbol">c</font
><sup>2</sup> best fit is

<br clear="all" /><table border="0" width="100%"><tr><td>
<table align="center"><tr><td nowrap="nowrap" align="center">
<span class="roman">Var</span>(B<sub>x</sub>) = 1.6 (<font face="symbol">á</font
>B<sub>1</sub> <font face="symbol">ñ</font
><font face="symbol">-</font
> <font face="symbol">á</font
>B<sub>2</sub> <font face="symbol">ñ</font
><sub><span class="roman">max</span></sub>) <font face="symbol">-</font
> 0.1</td></tr></table>
</td><td width="1%">(4.1)</td></tr></table>


The existence of ripples therefore appears to require the presence of an overshoot, with the amplitude of the ripples being strongly dependent on the size of the overshoot.  The outlying point above <span class="roman">Var</span>(B<sub>x</sub>) = 3 is the strongest shock, with an inflow speed of 6v<sub>A</sub>.  The cluster of four points around <span class="roman">Var</span>(B<sub>x</sub>) = 1 all have an inflow speed of 4v<sub>A</sub>, but have different values of <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>.  The range of (<font face="symbol">á</font
>B<sub>1</sub> <font face="symbol">ñ</font
><font face="symbol">-</font
> <font face="symbol">á</font
>B<sub>2</sub> <font face="symbol">ñ</font
><sub><span class="roman">max</span></sub>) for these four points is consistent with the variation seen during the course of a simulation.   Figure <a href="#fig:varBx_vs_tBn">4.8</a> shows how Var(B<sub>x</sub>) varies with <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub> for the shocks in this cluster.  This shows that <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub> does have an effect on the strength of the ripples, with the power in the ripples increasing as <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub> approaches 90<sup><font face="symbol">°</font
></sup>.  The effect of <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub> on the strength of the shock ripples is, however, significantly less than that of the size of the overshoot. 

<div class="p"></div>
A significant approximation made in our simulations is that there are no upstream waves.  We have seen that the strength of rippling seems to be determined by the height of the overshoot, rather than the angle between the upstream field and the shock front.  The introduction of upstream waves might cause local variations in <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>, but would not affect the plasma inflow speed.  This suggests that a reasonable level of upstream wave activity is unlikely to have a significant effect on ripple properties and that it is therefore reasonable to neglect upstream waves in our simulations.

<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.9">
</a> <center>

<a href="figs/ripples/ripple_bx_th85ma4.eps">
<img alt="th88_Btot" src="images/ripple_bx_th85ma4.gif" border="0"></a>&nbsp;&nbsp;&nbsp;
<a href="figs/ripples/ripple_bx_th88ma2.eps">
<img alt="th88_Etot" src="images/ripple_bx_th88ma2.gif" border="0"></a>

<div class="p"></div>
<a href="figs/ripples/ripple_bx_th88ma4.eps">
<img alt="th88_alfven" src="images/ripple_bx_th88ma4.gif" border="0"></a>&nbsp;&nbsp;&nbsp;
<a href="figs/ripples/ripple_bx_th88ma6.eps">
<img alt="th88_rho" src="images/ripple_bx_th88ma6.gif" border="0"></a>

<div class="p"></div>
<center>Figure 4.9: These figures show the how the square of B<sub>x</sub>, integrated over the y direction, varies with x for a variety of different upstream parameters.  The value of the total magnetic field integrated over y is shown for comparison.  The <font face="symbol">á</font
>B<sub>x</sub><sup>2</sup> <font face="symbol">ñ</font
> quantity is an indicator of the power in the ripples at a given x.  The location of a kink in the graph is indicated by a dashed line.</center>
<a name="fig:ripple_Bx_power">
</a>
</center>
<div class="p"></div>
Figure <a href="#fig:ripple_Bx_power">4.9</a> shows how the power in the ripples varies across the shock transition for a number of different shocks.  The quantity <font face="symbol">á</font
>B<sub>x</sub><sup>2</sup> <font face="symbol">ñ</font
> is plotted logarithmically, since the dynamic range is large and the dependence of <font face="symbol">á</font
>B<sub>x</sub><sup>2</sup> <font face="symbol">ñ</font
> on x appears to be approximately exponential.  The mean magnetic field strength, <font face="symbol">á</font
>B <font face="symbol">ñ</font
>, is shown for comparison on a linear scale.  The strength of ripples increases with both the Alfv&#233;n Mach number, M<sub><span class="roman">A</span></sub>, and the angle between the upstream magnetic field and the shock normal, <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>.  In the case of the <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=88<sup><font face="symbol">°</font
></sup>, V<sub><span class="roman">in</span></sub>=2v<sub>A</sub> shock, there is no evidence of rippling at the shock ramp, as the power in B<sub>x</sub> is actually below that downstream of the shock.  It should be noted that this is also the only shock that exhibits no clear overshoot.

<div class="p"></div>
The other three cases, however, do have appreciable rippling and have much in common.  The power in B<sub>x</sub> in the upstream region, which represents noise in the simulation, is at a low level and is approximately constant.  The rise in power begins upstream of the shock foot and is approximately exponential.  In this portion of the field, the e-folding length is approximately the same for all three cases.  At a point in the shock foot, however, the field exhibits a kink in the exponential rise.  Downstream of this point, the exponential form continues, but the rise is less rapid and the e-folding length differs between the three cases.  The exponential rise ends in a turnover whose position coincides with the top of the overshoot.  The power in B<sub>x</sub> decays exponentially from this point until it reaches its downstream equilibrium value.  The position of this kink is indicated in Figure <a href="#fig:flow_speed">4.10</a> by a dashed line.

<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.10">
</a> <center>

<a href="figs/ripples/inflow_th85m4.eps">
<img alt="inflow_th85m4" src="images/inflow_th85m4.gif" border="0"></a>&nbsp;&nbsp;&nbsp;
<a href="figs/ripples/inflow_th88m2.eps">
<img alt="inflow_th88m2" src="images/inflow_th88m2.gif" border="0"></a>

<div class="p"></div>
<a href="figs/ripples/inflow_th88m4.eps">
<img alt="inflow_th88m4" src="images/inflow_th88m4.gif" border="0"></a>&nbsp;&nbsp;&nbsp;
<a href="figs/ripples/inflow_th88m6.eps">
<img alt="inflow_th88m6" src="images/inflow_th88m6.gif" border="0"></a>

<div class="p"></div>
<center>Figure 4.10: Graphs of the local flow speeds in units of the local fast mode and Alfv&#233;n speeds variety of shock transitions.  The location of the kink in the ripple amplitude shown in Figure <a href="#fig:ripple_Bx_power">4.9</a> is indicated by a dashed line.</center>
<a name="fig:flow_speed">
</a>
</center>
<div class="p"></div>
The plasma flow speed is an interesting quantity within the shock structure, particularly in relation to the kink seen in the B<sub>x</sub> field component.  We can determine the speed of the flow by neglecting temporal variations and considering the continuity of the plasma, so that the quantity <font face="symbol">r</font
><b>v</b> is conserved.  The flow speed is useful in terms of the local Alfv&#233;n speed, v<sub>A*</sub>, since this is the characteristic speed for parallel propagating waves.  We will use the * subscript to denote that the characteristic speed is calculated locally, and is not simply the upstream value that is defined by the initial conditions.  In terms of the normalisation used in the simulation, v<sub>A*</sub> is given by

<br clear="all" /><table border="0" width="100%"><tr><td>
<table align="center"><tr><td nowrap="nowrap" align="center">
v<sub>A*</sub> = </td><td nowrap="nowrap" align="center">
&nbsp;B
<div class="hrcomp"><hr noshade="noshade" size="1"/></div><table border="0"><tr><td nowrap="nowrap" align="center">
</td><td align="left" class="cl"><br /><font face="symbol"><font size="+2">Ö</font><br /></font>                                </td><td nowrap="nowrap" align="center">

<div class="hrcomp"><hr noshade="noshade" size="1"/></div>
<div class="norm"><font face="symbol">r</font
><br /></div>                                </td></tr></table></td><td nowrap="nowrap" align="center">
</td></tr></table>
</td><td width="1%">(4.2)</td></tr></table>


so that the Alfv&#233;n Mach number of the flow is given by
<a name="equn:flow_alfven">
</a>
<br clear="all" /><table border="0" width="100%"><tr><td>
<table align="center"><tr><td nowrap="nowrap" align="center">
M<sub>A</sub> = V<sub>0</sub> </td><td nowrap="nowrap" align="center">
&nbsp;1
<div class="hrcomp"><hr noshade="noshade" size="1"/></div><table border="0"><tr><td nowrap="nowrap" align="center">
B </td><td align="left" class="cl"><br /><font face="symbol"><font size="+2">Ö</font><br /></font>                                </td><td nowrap="nowrap" align="center">

<div class="hrcomp"><hr noshade="noshade" size="1"/></div>
<div class="norm"><font face="symbol">r</font
><br /></div>                                </td></tr></table></td><td nowrap="nowrap" align="center">
</td></tr></table>
</td><td width="1%">(4.3)</td></tr></table>


The fast mode wave speed, v<sub>f</sub>, is the characteristic speed for perpendicular propagating waves.  The determination of this quantity requires the sound speed, c<sub>s</sub>, since

<br clear="all" /><table border="0" width="100%"><tr><td>
<table align="center"><tr><td nowrap="nowrap" align="center">
v<sub>f*</sub> = </td><td align="left" class="cl"><br /><font face="symbol"><font size="+2">Ö</font><br /></font>
<div class="comb">&nbsp;</div>
</td><td nowrap="nowrap" align="center">

<div class="hrcomp"><hr noshade="noshade" size="1"/></div>
<div class="norm">v<sub>A*</sub><sup>2</sup> + c<sub>s*</sub><sup>2</sup><br /></div>
<div class="comb">&nbsp;</div>
</td><td nowrap="nowrap" align="center">
</td></tr></table>
</td><td width="1%">(4.4)</td></tr></table>


In terms of the initial ion and electron betas, <font face="symbol">b</font
><sub>i</sub> and <font face="symbol">b</font
><sub>e</sub>, the sound speed depends on the ratio of the ion temperature, T, to its upstream value, T<sub>0</sub>, such that

<br clear="all" /><table border="0" width="100%"><tr><td>
<table align="center"><tr><td nowrap="nowrap" align="center">
c<sub>s*</sub><sup>2</sup> = </td><td nowrap="nowrap" align="center">
&nbsp;1
<div class="hrcomp"><hr noshade="noshade" size="1"/></div>2<br /></td><td nowrap="nowrap" align="center">
</td><td align="left" class="cl"><font face="symbol">
æ<br />è
</font></td><td nowrap="nowrap" align="center">
<font face="symbol">b</font
><sub>i</sub> </td><td nowrap="nowrap" align="center">
&nbsp;T
<div class="hrcomp"><hr noshade="noshade" size="1"/></div>T<sub>0</sub><br /></td><td nowrap="nowrap" align="center">
+ <font face="symbol">b</font
><sub>e</sub> </td><td align="left" class="cl"><font face="symbol">
ö<br />ø
</font></td><td nowrap="nowrap" align="center">
</td></tr></table>
</td><td width="1%">(4.5)</td></tr></table>


so that the fast mode Mach number of the flow is given by
<a name="equn:flow_fast">
</a>
<br clear="all" /><table border="0" width="100%"><tr><td>
<table align="center"><tr><td nowrap="nowrap" align="center">
M<sub>f</sub> = </td><td nowrap="nowrap" align="center">
&nbsp;V<sub>0</sub>
<div class="hrcomp"><hr noshade="noshade" size="1"/></div><font face="symbol">r</font
><br /></td><td nowrap="nowrap" align="center">
</td><td align="left" class="cl"><font face="symbol">
æ<br />è
</font></td><td nowrap="nowrap" align="center">
&nbsp;B<sup>2</sup>
<div class="hrcomp"><hr noshade="noshade" size="1"/></div><font face="symbol">r</font
><br /></td><td nowrap="nowrap" align="center">
+ </td><td nowrap="nowrap" align="center">
&nbsp;1
<div class="hrcomp"><hr noshade="noshade" size="1"/></div>2<br /></td><td nowrap="nowrap" align="center">
</td><td align="left" class="cl"><font face="symbol">
æ<br />è
</font></td><td nowrap="nowrap" align="center">
 <font face="symbol">b</font
><sub>i</sub> </td><td nowrap="nowrap" align="center">
&nbsp;T
<div class="hrcomp"><hr noshade="noshade" size="1"/></div>T<sub>0</sub><br /></td><td nowrap="nowrap" align="center">
+ <font face="symbol">b</font
><sub>e</sub> </td><td align="left" class="cl"><font face="symbol">
ö<br />ø
</font></td><td align="left" class="cl"><font face="symbol">
ö<br />ø
</font></td><td nowrap="nowrap" align="center">
<font size="-1"><font face="symbol">-</font
>1/2</font><!--sup
--><br /><br />
<font size="-1"></font>&nbsp;<br /></td><td nowrap="nowrap" align="center">
</td></tr></table>
</td><td width="1%">(4.6)</td></tr></table>



<div class="p"></div>
The quantities shown in Figure <a href="#fig:sum_fields">4.3</a> can be used, along with the ion temperature and the parameters shown in Table <a href="#tab:std_params">4.1</a> to determine the speed of the flow in terms of the Alfv&#233;n and fast mode wave speeds.  The ion temperature is determined by calculating <font face="symbol">á</font
><b>v</b> <font face="symbol">-</font
> [<font face="symbol">`</font
>(<b>v</b>)] <font face="symbol">ñ</font
> for each grid cell.  <a href="#mckean++95" name="CITEmckean++95">McKean <em>et&nbsp;al.</em> [1995]</a> report an ion temperature increase at the overshoot by a factor of around fifty over the upstream value, which results in a fast mode wave speed at the overshoot of v<sub>f</sub> = 3.7 v<sub>A</sub>.  These figures are consistent with our temperature diagnostics.

<div class="p"></div>
Figure <a href="#fig:flow_speed">4.10</a> shows graphs of the plasma flow speed in the shock rest frame as a function of x in terms of the local Alfv&#233;n and fast mode wave speeds.  The graphs were obtained using Equations <a href="#equn:flow_alfven">4.3</a> and <a href="#equn:flow_fast">4.6</a> and averaging the results over y.  A comparison of Figure <a href="#fig:ripple_Bx_power">4.9</a> with Figure <a href="#fig:flow_speed">4.10</a> shows that, for all shocks except for the V<sub><span class="roman">in</span></sub>=2v<sub>A</sub> case, the position of the kinks in the B<sub>x</sub> power graphs correspond to a local flow velocity of (1.26 <font face="symbol">±</font
>0.16) v<sub>f*</sub>.  This figure is rather sensitive to the exact position used to determine the velocities and is therefore consistent with the position of the sub-fast transition.  In all cases the sub-fast transition occurs near the top of the shock foot, with the Alfv&#233;nic transition occurring further downstream near the overshoot.  Although the fast mode and Alfv&#233;n speeds and transitions are not dramatically different, the position of the kink seems to be consistent with the fast mode transition, but not the Alfv&#233;nic transition.  This is significant because MHD waves are unable to propagate upstream of the fast mode transition, so the steepening of the B<sub>x</sub> rippling upstream of the kink may be evidence of evanescent behaviour.  In Section <a href="#sec:surface_mode">4.6</a>, we discuss how these results suggest that the ripples might be a form of surface mode.

<div class="p"></div>
 <h2><a name="tth_sEc4.5">
4.5</a>&nbsp;&nbsp;Fourier Analysis</h2>

<div class="p"></div>
In order to further characterise the properties of the B<sub>x</sub> ripples, we can apply Fourier analysis to determine their dispersion relation.  We do this by taking a time series of B<sub>x</sub> field slices at a constant distance from the shock front.  These field slices, along with their position relative to the shock, are shown in Figure <a href="#fig:FT_slices">4.11</a>.  Taking the Fourier transform of these y<font face="symbol">-</font
>t slices has the effect of inverting the axis quantities, so that the result is a map of wave amplitude in <font face="symbol">w</font
><font face="symbol">-</font
>k space.  We square these quantities to obtain a power spectrum.  The line of maximum power in these maps gives us the waves' dispersion relation.

<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.11">
</a> <center><a href="images/FT_slices.gif">
<img alt="FT_slices" src="images/FT_slices.gif" border="0"></a>

<center>Figure 4.11: These slices of the B<sub>x</sub> field (top) were taken in the shock frame at the positions indicated (bottom).  The colour scale is the same as that used for the B<sub>x</sub> component in Figure <a href="#fig:EB_fields">4.2</a>.</center>
<a name="fig:FT_slices">
</a>
</center>
<div class="p"></div>
We calculate our Fourier transforms using a fast Fourier transform algorithm in 2-D, as implemented by <a href="#press++92" name="CITEpress++92">Press <em>et&nbsp;al.</em> [1992]</a>.  It is a feature of Fourier transforms that the data are assumed to be periodic.  In addition, the fast Fourier transform algorithm requires that the data be supplied on a grid whose axes have a length in grid cells that is a power of two.  In our simulations, the y boundary conditions are periodic and we set the number of cells in the y direction to be a power of two.  In the time direction, however, we must pad the data with zeros in order to make the number of grid cells up to a power of two.  The time boundary is also not periodic, so we are effectively introducing a discontinuity in t that can produce high frequency artifacts such as signal leakage.

<div class="p"></div>
Data windowing, in which the data set is multiplied by a windowing function, reduces the extent to which a signal in a power spectrum leaks into neighbouring cells.  This is particularly important in our data sets, where most of the power lies in a small number of bins.  We find that the simplest choice of windowing function, the Bartlett window, works well.  The Bartlett windowing function is zero at the edges of the data segment and rises linearly to a value of one in the centre.

<div class="p"></div>
Only frequencies that lie below a critical frequency, termed the Nyquist frequency, f<sub>N</sub>, are included in a Fourier transform.  This range of frequencies is determined by the sampling interval, <font face="symbol">D</font
>t, such that

<br clear="all" /><table border="0" width="100%"><tr><td>
<table align="center"><tr><td nowrap="nowrap" align="center">
f<sub>N</sub> = </td><td nowrap="nowrap" align="center">
&nbsp;1
<div class="hrcomp"><hr noshade="noshade" size="1"/></div>2 <font face="symbol">D</font
>t<br /></td><td nowrap="nowrap" align="center">
</td></tr></table>
</td><td width="1%">(4.7)</td></tr></table>

 
Power above this frequency is folded back over below f<sub>n</sub>, or "aliased" into the Fourier transform, and is effectively a source of noise.  Similarly, the critical wavenumber, k<sub>N</sub>, depends on the spatial grid size, <font face="symbol">D</font
>y.  The resolution of the Fourier transform is governed by the number of data points to be transformed, as the number of cells on the axes of the Fourier transform is equal to the number of cells on the equivalent data axes.  This effectively means that the lowest resolvable frequency depends on the length of the data set and the highest resolvable frequency depends on the sampling interval.

<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.12">
</a> <center>

<a href="images/FT_spectra_upstream.gif">
<img alt="FT_spectra_upstream" src="images/FT_spectra_upstream.gif" border="0"></a>
<a href="images/FT_spectra_downstream.gif">
<img alt="FT_spectra_downstream" src="images/FT_spectra_downstream.gif" border="0"></a>

<center>Figure 4.12: The Fourier plots (left) show the <font face="symbol">w</font
><font face="symbol">-</font
>k distribution of power for the B<sub>x</sub> slices (Figure <a href="#fig:FT_slices">4.11</a>) using a logarithmic scaling.  The <font face="symbol">w</font
><font face="symbol">-</font
>power plots (right) show slices through the <font face="symbol">w</font
><font face="symbol">-</font
>k diagrams at k=1 (8<sup>th</sup> Fourier mode).  Figure <a href="#fig:FT_spectra_shock">4.13</a> shows equivalent diagrams for regions inside the shock.</center>
<a name="fig:FT_spectra_bdy">
</a>
</center>
<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.13">
</a> <center>

<a href="images/FT_spectra_foot.gif">
<img alt="FT_spectra_foot" src="images/FT_spectra_foot.gif" border="0"></a>&nbsp;&nbsp;&nbsp;
<a href="images/FT_spectra_overshoot.gif">
<img alt="FT_spectra_overshoot" src="images/FT_spectra_overshoot.gif" border="0"></a>

<center>Figure 4.13: The Fourier plots (left) show the <font face="symbol">w</font
><font face="symbol">-</font
>k distribution of power for the B<sub>x</sub> slices (Figure <a href="#fig:FT_slices">4.11</a>) using a logarithmic scaling.  The <font face="symbol">w</font
><font face="symbol">-</font
>power plots (right) show slices through the <font face="symbol">w</font
><font face="symbol">-</font
>k diagrams at k=1 (8<sup>th</sup> Fourier mode).  Figure <a href="#fig:FT_spectra_bdy">4.12</a> shows equivalent diagrams for regions outside the shock.</center>
<a name="fig:FT_spectra_shock">
</a>
</center>
<div class="p"></div>
Figures <a href="#fig:FT_spectra_bdy">4.12</a> and <a href="#fig:FT_spectra_shock">4.13</a> show <font face="symbol">w</font
><font face="symbol">-</font
>k power spectrum maps of field slices at various positions relative to the shock front.  The dynamic range of these maps is sufficiently large that the power is plotted on a logarithmic scale.  Also shown are slices through these maps at k=1 (the 8<sup>th</sup> Fourier mode), which show how the power varies with <font face="symbol">w</font
>.  These slices provide a colour key and illustrate the noise level in the <font face="symbol">w</font
><font face="symbol">-</font
>k maps.

<div class="p"></div>
Figure <a href="#fig:FT_spectra_bdy">4.12</a> shows that there is no significant wave activity upstream of the shock.  It is difficult to resolve a dispersion relation and the power graph at k=1 suggests that any signal is lost in noise.  The downstream power graph shows a peak at <font face="symbol">w</font
> <font face="symbol">»</font
> 1.5 <font face="symbol">W</font
><sub>i</sub>.  There is definite wave activity on the <font face="symbol">w</font
><font face="symbol">-</font
>k map, although it is difficult to resolve a dispersion relation.  This is because we are effectively measuring k<sub><font face="symbol">||</font
></sub>, but the frequency determined by the fast mode dispersion relation depends on <font face="symbol">|</font
>k<font face="symbol">|</font
>, not k<sub><font face="symbol">||</font
></sub>.  For a given k<sub><font face="symbol">||</font
></sub> we therefore sample waves at a range of <b>k</b> and hence a range of <font face="symbol">w</font
>.  These results are consistent with the field slices in Figure <a href="#fig:FT_slices">4.11</a>.

<div class="p"></div>
Figure <a href="#fig:FT_spectra_shock">4.13</a> shows that the wave activity in B<sub>x</sub> within the shock front is considerably different from that outside.  There is significantly more power in the k=1 slices, with the peak at <font face="symbol">w</font
> <font face="symbol">»</font
> 2 <font face="symbol">W</font
><sub>i</sub> being at a slightly higher frequency that for the downstream waves.  There is also significantly more power at the overshoot than at the foot, which would be consistent with the exponential growth seen in Figure <a href="#fig:ripple_Bx_power">4.9</a>.  Although the ripples in B<sub>x</sub> look like "blobs" of field structure, they actually show very clear wave mode properties.  The power spectrum shows a clear dispersion relation, in contrast to the downstream spectrum.  The signal remains clear up to around <font face="symbol">|</font
>k<font face="symbol">|</font
> = 2.5 <font face="symbol">W</font
><sub>i</sub> v<sub>A</sub><sup><font face="symbol">-</font
>1</sup>.  This value is much higher than that for downstream waves, but the fact that it is approximately constant between the foot and the overshoot, which have very different power to noise ratios, suggests that this may be a real high frequency cut-off.  The region of maximum power in Figure <a href="#fig:FT_spectra_shock">4.13</a> corresponds to a few ion inertial lengths, which agrees with the apparent wavelength of the ripples seen in the B<sub>x</sub> field component in Figure <a href="#fig:EB_fields">4.2</a>.

<div class="p"></div>

<div class="p"></div>
<a name="tth_tAb4.3">
</a> <center>
<table>
<tr><td align="center">Plasma inflow speed </td><td colspan="2" align="center">[(<font face="symbol">¶</font
><font face="symbol">w</font
>)/(<font face="symbol">¶</font
>k)] </td></tr>
<tr><td align="center">V<sub><span class="roman">in</span></sub> </td><td align="center">- branch </td><td align="center">+ branch </td></tr>
<tr><td align="center">2 v<sub>A</sub>  </td><td align="center">-1.68 v<sub>A</sub> </td><td align="center">1.76 v<sub>A</sub> </td></tr>
<tr><td align="center">4 v<sub>A</sub> </td><td align="center">-2.34 v<sub>A</sub> </td><td align="center">1.97 v<sub>A</sub> </td></tr>
<tr><td align="center">6 v<sub>A</sub> </td><td align="center">-2.54 v<sub>A</sub> </td><td align="center">2.73 v<sub>A</sub> </td></tr></table>


<center>Table 4.3: Relationship between the plasma inflow speed in the frame of the simulation, V<sub><span class="roman">in</span></sub>, and the <font face="symbol">c</font
><sup>2</sup> best fit gradient of the dispersion relation for a range of shocks with <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=85<sup><font face="symbol">°</font
></sup>.</center>
<a name="tab:ripple_speeds">
</a>
</center>
<div class="p"></div>
The dispersion relation for these waves appears to be linear, with equal phase and group velocities.  If

<br clear="all" /><table border="0" width="100%"><tr><td>
<table align="center"><tr><td nowrap="nowrap" align="center">
<font face="symbol">w</font
> =  mk+c</td></tr></table>
</td><td width="1%">(4.8)</td></tr></table>


then a <font face="symbol">c</font
><sup>2</sup> fit is suitable for determining the dispersion relation and hence the phase and group velocity of the ripples.  We use a statistical weight for each power point equal to the logarithm of the power at that point.  The fitting is done only over that part of the spectrum with <font face="symbol">|</font
>k<font face="symbol">|</font
>  &lt;  2 <font face="symbol">W</font
><sub>i</sub> v<sub>A</sub><sup><font face="symbol">-</font
>1</sup>, since the presence of a high frequency cut-off means that the signal becomes lost in noise outside this range.  By inspection of Figure <a href="#fig:FT_spectra_shock">4.13</a>, we expect the dispersion relation to pass through the origin.  Our <font face="symbol">c</font
><sup>2</sup> fits, however, produce values of c as high as 1.  This is clearly an inappropriate fit and can be explained by the fact that the points in the <font face="symbol">w</font
><font face="symbol">-</font
>k map that carry most power (and hence statistical weight) are spread over a few cells in <font face="symbol">w</font
>, probably as a result of signal leakage, which is not completely eliminated by the Bartlett windowing.  We found that setting c=0 produced much more realistic <font face="symbol">c</font
><sup>2</sup> fits.  Using this method, we obtain <font face="symbol">c</font
><sup>2</sup> best fit velocities for the ripples for a variety of shock Mach numbers at <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=85<sup><font face="symbol">°</font
></sup>.  These results are shown in Table <a href="#tab:ripple_speeds">4.3</a>.

<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.14">
</a> <center><a href="figs/ripples/dispersion_chart.eps">
<img alt="dispersion_chart" src="images/dispersion_chart.gif" border="0"></a>

<center>Figure 4.14: Chart correlating the speed of ripples to other significant wave speeds at <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=85<sup><font face="symbol">°</font
></sup>.  The crosses correspond to the measured best <font face="symbol">c</font
><sup>2</sup> fit to the ripple speed, the open circles to the overshoot Alfv&#233;n speed and the solid triangles to the downstream Alfv&#233;n speed.</center>
<a name="fig:ripple_speed">
</a>
</center>
<div class="p"></div>
We can compare the speed of the ripples with wave speeds within the simulation.  Since the speed that we have calculated is really just the parallel (y) component of the ripple phase speed, the appropriate wave speed to compare is with is the Alfv&#233;n speed, which is the characteristic parallel wave speed.  It is straightforward to calculate the overshoot and downstream Alfv&#233;n speeds because we can read off <font face="symbol">r</font
> and B directly from our simulation, from which we can calculate both the local and averaged Alfv&#233;n speeds (Figure <a href="#fig:sum_fields">4.3</a>).  Figure <a href="#fig:ripple_speed">4.14</a> compares these waves speeds with the speed of the ripples.  The plasma inflow speeds are shown in the frame of the shock, as opposed to the frame of the simulation used in Table <a href="#tab:ripple_speeds">4.3</a>.  This graph shows that the ripples move along the shock front at a speed that is consistent with the Alfv&#233;n speed at the overshoot [<a href="#lowe+burgess99a" name="CITElowe+burgess99a">Lowe &amp; Burgess, 1999a</a>].

<div class="p"></div>

<div class="p"></div>
<a name="tth_fIg4.15">
</a> <center>

<a href="figs/ripples/FT_Bx_component.eps">
<img alt="FT_Bx_component" src="images/FT_Bx_component.gif" border="0"></a>

<div class="p"></div>
<a href="figs/ripples/FT_By_component.eps">
<img alt="FT_By_component" src="images/FT_By_component.gif" border="0"></a>&nbsp;&nbsp;&nbsp;
<a href="figs/ripples/FT_Bz_component.eps">
<img alt="FT_Bz_component" src="images/FT_Bz_component.gif" border="0"></a>

<div class="p"></div>

<center>Figure 4.15: Fourier transforms of the three magnetic field components of a field slice running along the shock overshoot of a <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=88<sup><font face="symbol">°</font
></sup>, V<sub><span class="roman">in</span></sub>=4v<sub>A</sub> simulation. </center>
<a name="fig:ripple_fourier_components">
</a>
</center>
<div class="p"></div>
In order to look at the properties of ripples in the other field components, we have looked at the Fourier transforms of all three magnetic field components.  Figure <a href="#fig:ripple_fourier_components">4.15</a> shows three Fourier transforms for a field slice running along the overshoot of a <font face="symbol">q</font
><sub><span class="roman">B</span><sub><span class="roman">n</span></sub></sub>
=88<sup><font face="symbol">°</font
></sup>, V<sub><span class="roman">in</span></sub>=4v<sub>A</sub> simulation.  As we have seen previously, the B<sub>x</sub> component has clear wave mode properties with both group and phase velocities approximately equal to the overshoot Alfv&#233;n speed.  The peak signal is at around <font face="symbol">|</font
>k<font face="symbol">|</font
> = 1.4 <font face="symbol">W</font
><sub>i</sub> v<sub>A</sub><sup><font face="symbol">-</font
>1</sup> and <font face="symbol">w</font
> =  3 <font face="symbol">W</font
><sub>i</sub>.

<div class="p"></div>
The B<sub>y</sub> field component has a large amount of power across all frequencies at k=0.  This is a result of the movement of the whole shock front with respect to the frame in which the Fourier transform is taken.  Outside k=0, there is evidence for wave mode properties similar to the B<sub>x</sub> field component, but with a low frequency cut-off at around <font face="symbol">w</font
> =  1.5 <font face="symbol">W</font
><sub>i</sub>.  The position of the peak signal corresponds to that in the B<sub>x</sub> component.  The B<sub>z</sub> behaviour is very different to the B<sub>x</sub> and B<sub>y</sub> components, with no clear dispersion relation.  There is a strong signal at a position corresponding to the maxima in both the B<sub>x</sub> and B<sub>y</sub> components.  The power at this frequency is distributed over a range of k, which may correspond to a wave with a very large group velocity, or to signal leakage through k.  Apart from this peak, there is relatively little power at other frequencies.

<div class="p"></div>
These results confirm that the properties of the ripples are clearest in the B<sub>x</sub> field component, but also suggest that further work on the other field components will be needed for a complete understanding of the waves processes at the overshoot.

<div class="p"></div>
     <h3><a name="tth_sEc4.5.1">
4.5.1</a>&nbsp;&nbsp;Numerical dependence</h3>

<div class="p"></div>
<a name="sec:fields_numerical_dep">
</a>
<div class="p"></div>
<a name="tth_fIg4.16">
</a> <center><a href="figs/ripples/th88bp5m4a_Bx_FT_full.eps">
<img alt="th88bp5m4a_Bx_FT_full" src="images/th88bp5m4a_Bx_FT_full.gif" border="0"></a>

<div class="p"></div>
<a href="figs/ripples/th88bp5m4c_Bx_FT_full.eps">
<img alt="th88bp5m4c_Bx_FT_full" src="images/th88bp5m4c_Bx_FT_full.gif" border="0"></a>

<div class="p"></div>
<center>Figure 4.16: Fourier transforms of the B<sub>x</sub> field component for simulations with different numerical parameters.  These graphs do not show the whole range of the Fourier transform, as only the region with <font face="symbol">|</font
>k<font face="symbol">|</font
> &lt; 2 was used to fit a dispersion relation.  Outside this range, any signal becomes lost in noise.</center>
<a name="fig:numerical_FTs">
</a>
</center>
<div class="p"></div>
It is important to ensure that our results are neither a result of, nor significantly dependent on, the numerical resolution of the simulation grid.  Figure <a href="#fig:numerical_FTs">4.16</a> shows Fourier transforms of the B<sub>x</sub> field component for simulations with different numerical parameters.  The first case represents our standard simulation parameters.  In the second case, we have doubled both the spatial grid spacings, <font face="symbol">D</font
>x and <font face="symbol">D</font
>y, and the time step, <font face="symbol">D</font
>t.  If any of the properties of the ripples are dependent on numerical resolution, we would expect features of the ripples to scale with at least one of these.

<div class="p"></div>

<div class="p"></div>
<a name="tth_tAb4.4">
</a> <center>
<table>
<tr><td align="center"><font face="symbol">D</font
>x </td><td align="center"><font face="symbol">D</font
>y </td><td align="center"><font face="symbol">D</font
>t </td><td colspan="2" align="center">[(<font face="symbol">¶</font
><font face="symbol">w</font
>)/(<font face="symbol">¶</font
>k)] </td></tr>
<tr><td align="center"></td><td align="center"></td><td align="center"></td><td align="center">- branch </td><td align="center">+ branch </td></tr>
<tr><td align="center">0.2 v<sub>A</sub> <font face="symbol">W</font
><sub>i</sub><sup><font face="symbol">-</font
>1</sup> </td><td align="center">0.2 v<sub>A</sub> <font face="symbol">W</font
><sub>i</sub><sup><font face="symbol">-</font
>1</sup> </td><td align="center">0.01 <font face="symbol">W</font
><sub>i</sub><sup><font face="symbol">-</font
>1</sup> </td><td align="center">-2.21 v<sub>A</sub> </td><td align="center">2.19 v<sub>A</sub> </td></tr>
<tr><td align="center">0.4 v<sub>A</sub> <font face="symbol">W</font
><sub>i</sub><sup><font face="symbol">-</font
>1</sup> </td><td align="center">0.4 v<sub>A</sub> <font face="symbol">W</font
><sub>i</sub><sup><font face="symbol">-</font
>1</sup> </td><td align="center">0.02 <font face="symbol">W</font
><sub>i</sub><sup><font face="symbol">-</font
>1</sup> </td><td align="center">-2.40 v<sub>A</sub> </td><td align="center">2.34 v<sub>A</sub> </td></tr></table>


<center>Table 4.4: Fourier spectrum <font face="symbol">c</font
><sup>2</sup> best fit dispersion relations for a high and low resolution case to illustrate that our results are not resolution dependent.</center>
<a name="tab:numerical_dependence">
</a>
</center>
<div class="p"></div>
The form of the <font face="symbol">w</font
><font face="symbol">-</font
>k power maps appears to be consistent across the two cases, with both spectra showing a linear dispersion relation with a high frequency cut-off at around <font face="symbol">|</font
>k<font face="symbol">|</font
> = 2.5 <font face="symbol">W</font
><sub>i</sub> v<sub>A</sub><sup><font face="symbol">-</font
>1</sup>.  The <font face="symbol">c</font
><sup>2</sup> best fit dispersion relation gradients are shown in Table <a href="#tab:numerical_dependence">4.4</a>.  These agree to within 10%, which is small compared to the dramatic change in numerical resolution.  We therefore conclude that the B<sub>x</sub> ripples do not show significant numerical dependence.

<div class="p"></div>
 <h2><a name="tth_sEc4.6">
4.6</a>&nbsp;&nbsp;Shock Surface Modes</h2>

<div class="p"></div>
<a name="sec:surface_mode">
</a>
<div class="p"></div>
<a name="tth_fIg4.17">
</a> <center><a href="figs/ripples/surface_wave_sketch.eps">
<img alt="surface_wave_sketch" src="images/surface_wave_sketch.gif" border="0"></a>

<center>Figure 4.17: A sketch of our model for a shock surface wave.  The surface mode consists of a pair of exponential solutions which meet at the top of the overshoot.  At a point upstream of the overshoot, the local flow velocity exceeds the local fast mode wave speed and the surface mode's exponential solution (dotted line) decays into an evanescent wave.</center>
<a name="fig:surface_sketch">
</a>
</center>
<div class="p"></div>
We argue here that collisionless shocks may be able to support a surface mode.  The existence of a surface mode at tangential discontinuities is described by <a href="#hollweg82" name="CITEhollweg82">Hollweg [1982]</a>.  His analysis consists of considering the MHD equations and making a number of simplifying assumptions.  He considered a cold plasma, with constant density and field magnitude across the discontinuity.  The regions on either side of the discontinuity are homogeneous, and the discontinuity consists only of a change in the magnetic field direction.  The surface mode is then identified by matching exponential solutions on either side of the discontinuity and introducing a boundary at infinity at which the wave amplitude goes to zero.  This has the effect of constraining the solution to the region of the discontinuity.  

<div class="p"></div>
A surface mode analysis is significantly more complicated for the discontinuity at a shock overshoot.  This is because the density and magnetic field strength are very strong functions of position.  The main difference is that, in the case of a collisionless shock, the discontinuity surface is treated as being the top of the overshoot and the upstream region is that portion of the shock ramp lying between the top of the overshoot and the sub-fast transition.  Upstream of this point, the flow speed is greater than all plasma wave speeds and the surface mode becomes evanescent.  This transition corresponds with the kink that we observe in the B<sub>x</sub> field component.  A schematic view of our model is shown in Figure <a href="#fig:surface_sketch">4.17</a>.

<div class="p"></div>
In a shock surface mode treatment, the cold plasma assumption is also questionable, since the ion temperature can increase by a factor of fifty at the overshoot [<a href="#mckean++95" name="CITEmckean++95">McKean <em>et&nbsp;al.</em>, 1995</a>].  The nature of the discontinuity is different too.  In the case of the tangential discontinuity, the direction of the magnetic field changes discontinuously.  At the shock overshoot, it is the rate at which the field changes magnitude that is discontinuous.  The mode described by <a href="#hollweg82" name="CITEhollweg82">Hollweg [1982]</a> has a propagation velocity along the discontinuity that is determined by the wave speeds on either side of the discontinuity.  Although an analytical surface mode analysis is difficult in the shock case, we would expect any surface mode to share these two properties.  Since our analysis of the ripples lies in a direction that is parallel to the magnetic field, we would therefore expect the characteristic wave speed to be the overshoot Alfv&#233;n speed.  Also, since this is a surface mode, it should decay exponentially with distance from the discontinuity.  These expectations are consistent with our simulations.

<div class="p"></div>
If such a mode exists in a shock, there is likely to be sufficient energy available to excite it.  There is nothing to stop the surface mode being driven by an Alfv&#233;n Ion Cyclotron instability resulting from the reflected ions, as suggested by <a href="#winske+quest88" name="CITEwinske+quest88">Winske &amp; Quest [1988]</a>.  More work is needed to conclusively identify the wave mode responsible for rippling and to determine the source of the driving energy.

<div class="p"></div>
 <h2><a name="tth_sEc4.7">
4.7</a>&nbsp;&nbsp;Summary</h2> 

<div class="p"></div>
Our analysis has shown, for the first time, some new features of the shock ripples.  The power in the ripples varies with distance in an approximately exponential manner, reaching a maximum at the overshoot.   The graph of power with position exhibits a kink which means that the ripple power drops off upstream of a point which corresponds to the super-fast transition.  The ripples become weaker as the inflow velocity decreases and the existence of ripples seems to depend on the existence of an overshoot.  Finally, the ripples propagate at the overshoot Alfv&#233;n speed, possibly with a high frequency cut-off.  We argue that these properties are consistent with the ripples being a surface mode.


<div class="p"></div>

<br /><br /><hr /><small>
Page Maintained By : 
Rob Lowe<BR>
Last Revision : 1st March 2003
</body>
</html>
